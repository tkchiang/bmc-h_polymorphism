### Polymorphic _in vitro_ assembly of a bacterial microcompartment shell protein

This repository contains analysis scripts and processed results accompanying the paper 
"Polymorphic _in vitro_ assembly of a bacterial microcompartment shell protein". 

The repository is organized into three main analyses: 

- TEM image analysis of nanotubes
- MCMC fitting of SAXS data
- BMC-H subunit conformational flexibility analysis of all-atom MD trajectories
- Coarse-grained MD trajectory analysis of hexamer sheets

---

### Repository structure

| Folder | Notebooks / Scripts | Description / Output |
|-|-|-|
| `Nanotube_TEM_analysis/` | `nanotube_TEM_analysis.ipynb` | Automates analysis of nanotube TEM images. Outputs `tube_results.csv` with diameters and chiral angles. |
| | `plot_tube_results.ipynb` | Plots the data in `tube_results.csv`. |
| | | |
| `SAXS_MCMC/` | `run_SAXS_MCMC.ipynb` | Implements MCMC on processed SAXS data and generates backend files for each experiment. Depends on the functions defined in `saxs_helpers.py`. Outputs `emcee` backend files with names like `backend_{datafile}.h5`. |
| | `backend_analysis.ipynb` | Analyzes the `emcee` backend files generated by `run_SAXS_MCMC.ipynb`. |
| | `saxs_helpers.py` | Contains functions for plotting and defining SAXS models used in fitting. |
| | | |
| `conformational_flexibility/` | `RMSF_analysis.ipynb` | Reads processed aaMD trajectory data of BMC-H hexamers in various salt and urea conditions and computes average root mean square fluctuations. |
| | | |
| `cgMD_trajectory_analysis/` | `sheet_curvature_analysis.ipynb` | Reads cgMD trajectory data of BMC-H hexamer lattice sheets and computes local curvature over time. |

---

### Reproducibility

To run the notebooks, first create and activate a Conda environment:

```bash
conda env create -f environment.yml
conda activate polymorph_env
```

Notebooks are designed to run sequentially in each analysis folder. Processed data files included in the repository allow reproduction of the figures in the paper.

---

### Data

Raw experimental and simulation data (TEM images, SAXS data, and MD trajectories) are stored externally and will be provided to reviewers upon request.

Included/processed files:
- `Nanotube_TEM_analysis/tube_results.csv`: extracted nanotube diameters and chiral angles.
- `SAXS_MCMC/5djb_FoXS.dat`: simulated scattering curve of a BMC-H subunit (PDB ID: 5DJB), interpolated to match experimental data.

For full analysis, see the corresponding notebooks in each folder.

---

### Citation

If these scripts are to be used for reproducing or extending the analysis, please cite the paper:

"Polymorphic _in vitro_ assembly of a bacterial microcompartment shell protein".
